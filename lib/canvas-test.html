<!DOCTYPE html>
<html>
<body>
  <script   src="https://code.jquery.com/jquery-3.2.1.min.js"   integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="   crossorigin="anonymous"></script>

<canvas id="myCanvas" width="400" height="400" style="border:0px solid #000000;"></canvas>

<script>

var offsetToAngle = function(offset) {
	return 2 * Math.PI * offset;
};

var timeToOffset = function(hours, minutes, seconds) {
	return (hours % 12)/12 + minutes/12/60 + seconds/12/60/60;
};

var timeToPosition = function(hours, minutes, seconds) {
	var hoursOffset = timeToOffset(hours, minutes, seconds);
  var minutesOffset = timeToOffset(0, minutes, seconds) * 12;

  if (minutesOffset < hoursOffset) {
  	minutesOffset += 1;
  }

  var length = minutesOffset - hoursOffset;
  var center = hoursOffset + length / 2;

  if (center > 1) {
  	center -= 1;
  }

  return { center, length };
};

var canvas = document.getElementById("myCanvas");
var ctx = canvas.getContext("2d");

var currentPosition = null;

var draw = function(position) {
	currentPosition = position;

	ctx.save();
  ctx.clearRect(0, 0, 400, 400);
	ctx.translate(200, 200);
	ctx.rotate(-Math.PI/2 + offsetToAngle(position.center));

    var startAngle = -1 * offsetToAngle(position.length/2);
    var endAngle = offsetToAngle(position.length/2);

	ctx.beginPath();
	ctx.lineWidth = 50;
	ctx.arc(0, 0, 100, startAngle, endAngle);
	ctx.stroke();

	ctx.restore();
};

var getNowPosition = function() {
	var now = new Date();
	return timeToPosition(now.getHours(), now.getMinutes(), now.getSeconds());
};

var getLogoPosition = function() {
	return { center: 0.75, length: 0.7 };
};

var transition = {};
var transitionTo = function(newEndPosition) {
	var maxDuration = 300;

	var now = Date.now();

	if (newEndPosition) {
    	// New transition
      transition.from = currentPosition;
      transition.to = newEndPosition;

      var centerDiff = transition.to.center - transition.from.center;
      if (centerDiff < -0.5) {
      	centerDiff += 1;
      }
      else if (centerDiff > 0.5) {
      	centerDiff -= 1;
      }

      transition.diff = {
      	center: centerDiff,
      	length: transition.to.length - transition.from.length,
      };

      transition.at = now;
      transition.for = Math.max(Math.abs(transition.diff.length), Math.abs(transition.diff.center) * 2) * maxDuration;
  }

    // How far are we in the transition?
    var progress = Math.max(0, Math.min((now - transition.at) / transition.for, 1));

    var newPosition = {
    	center: transition.from.center + transition.diff.center * progress,
    	length: transition.from.length + transition.diff.length * progress,
    };

    draw(newPosition);
    if (progress < 1) {
    	window.requestAnimationFrame(transitionTo.bind(null, null));
    }
};



draw(getNowPosition());

// setTimeout(function() {
// 	transitionTo(getLogoPosition());
// }, 2000);

$('canvas').hover(() => transitionTo(getLogoPosition()), () => transitionTo(getNowPosition()))

</script>

</body>
</html>
